language: python
python:
- '3.6'
branches:
  only:
  - master
  - "/^v.*$/"
install:
- wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh
- bash miniconda.sh -b -p $HOME/miniconda
- export PATH="$HOME/miniconda/bin:$PATH"
- hash -r
- conda config --set always_yes yes --set changeps1 no
- conda update -q conda
- conda info -a
- conda env create -f environment.yml
- source activate deepDegron
- pyensembl install --release 75 --species human --custom-mirror https://github.com/openvax/ensembl-data/releases/download/GRCh37.75/
- python setup.py install
- train_cterm_model --help
- train_nterm_model --help
- deepDegron_test --help
- deepDegron_score --help
script: nosetests --nocapture tests/
deploy:
  provider: pypi
  username: ctokheim
  password:
    secure: mbc5WH1FCfgvoLkbUsnqBCxDt3kWS5jZtKj+6Uvcd8+VplOMu/vVP6gXWYYiLpIKMnC8kh67ZRGOox3SugR9O7X/6WN1jfmp/t4HGod9GACpId0gd9ysl/5U1Hi8QWVzNuJwzplBC9GTk8SMoZQAjdjuORvw8k+ogkLHHr3+EZ2eJnXk+Tg2PPZqcNv/JiEzPRI3JcXfIZHZWd2fFcsbHMmHez7pBhv0DUIRIZy7zJmd6S8Db8ZwBzS+6mFjtYnp00qsus2mGi2p2igItK3yomiUqaZ8ceFBRxamYNVO0fR7w4BMRk2n/WaQf1agj6PQZaEuOvw31TJLwWbmMZ4JUOQ+ob2KHYAJsOs8BsniObjVuoafxLLXfBxVW5XI5UGWclQssvTkWv4/w9s2TeEz8WKK5PEPaPPnFmMEJ2mJoRFHi/4ykREZ+ZJtoFG3Ym6cm3yK5Zuy7y8mop/68kkSyhIACwY5NiNszj46XXr3l7TuJlpSkin0IdxdfOA4gUWd8CM66Nixjh6U5h/NA6W1hSnwWeajZ7l+DCjg1mAPCq8/6fWNdqOJgFnR2YVKDGaxgvra59e0uFz688AICxDWXCTFKlNKSWhLy9aG3GyT43dJl063TL0CP4eyj4EdNtRpNBC5DJ0/JrmAh65eeZ9F8NBeeKcLPznzKa1y9OPj/2s=
  on:
    tags: true
    branch: master
